# QA Acceptance Criteria, Checklist & Smoke Tests

This document translates the SRS requirements into **Given/When/Then** acceptance criteria,
plus a QA checklist and a minimal smoke test suite for critical flows.

## 1) Acceptance Criteria by Module (Given/When/Then)

### 1.1 HR & Guard Enrollment Module
- **Guard profile capture**
  - **Given** a user with HR enrollment access, **when** they create a guard record, **then** the system requires personal, CNIC, medical, training, and bank details before saving. (SRS 3.1.1)
- **Mandatory document upload**
  - **Given** a new guard enrollment is in progress, **when** required documents are missing, **then** the system blocks submission and highlights the missing documents. (SRS 3.1.1)
- **Two‑step approval workflow**
  - **Given** a guard enrollment is submitted, **when** the Training Head reviews it, **then** they must enter a comment and approve/reject before it can move to COO review. (SRS 3.1.2)
  - **Given** the Training Head has approved, **when** the COO reviews, **then** a comment is required and the enrollment status updates to approved or rejected. (SRS 3.1.2)
- **Automatic status classification**
  - **Given** a guard’s enrollment/deployment timeline, **when** the guard is idle ≥ 7 days after enrollment, **then** the status is set to “Pending Deployment.” (SRS 3.1.3)
  - **Given** a guard is idle ≥ 1 month, **when** status recalculation runs, **then** the status is set to “Default.” (SRS 3.1.3)

### 1.2 Compliance & Risk Monitoring
- **CNIC expiry tracking**
  - **Given** a guard’s CNIC expiry date is within 30 days, **when** the compliance job runs, **then** the guard appears on the CNIC expiry dashboard list. (SRS 3.2.1)
  - **Given** a guard’s CNIC is expired, **when** dashboards load, **then** the guard is highlighted as expired. (SRS 3.2.1)
- **Age policy compliance**
  - **Given** the configurable age limit (default 55), **when** a guard exceeds the policy limit, **then** the guard is flagged for compliance review. (SRS 3.2.2)
- **Insurance/EOBI/Social Security coverage**
  - **Given** configurable capacity limits for coverage, **when** a guard is added/removed from a scheme, **then** the dashboard reflects updated filled vs vacant capacity. (SRS 3.2.3)
  - **Given** additions or deletions in coverage, **when** a report is generated by region/client, **then** the report reflects the change. (SRS 3.2.3)

### 1.3 Deployment & Operations Module
- **Live deployment dashboard**
  - **Given** deployed guard records exist, **when** the dashboard loads, **then** it shows region‑wise and client‑wise deployed guard counts. (SRS 3.3.1)
  - **Given** a location has a shortage, **when** the dashboard loads, **then** the shortage is visible at location level. (SRS 3.3.1)
- **Daily shortage report + attendance correction notice**
  - **Given** it is 5:00 PM, **when** the scheduled job runs, **then** a daily shortage report is generated. (SRS 3.3.2)
  - **Given** attendance is missing, **when** the shortage report is generated, **then** the system notifies the authorized user who can allow post‑date attendance updates. (SRS 3.3.2)
- **Guard rotation management**
  - **Given** a client rotation lock period (default 6 months), **when** a redeployment is attempted before lock expiry, **then** the system blocks the redeployment. (SRS 3.3.3)
- **Undue shuffling detection**
  - **Given** a guard changes assignment more than twice per week/month, **when** shuffling rules evaluate, **then** the guard is flagged and appears in supervisor‑ and region‑wise reports. (SRS 3.3.4)
- **Client‑wise deployment report**
  - **Given** deployments exist, **when** the client‑wise deployment report is generated, **then** it includes client/location, deployed guards, start/end dates, duration, and replacement history. (SRS 3.3.5)
  - **Given** a replacement occurs, **when** viewing the report, **then** it shows outgoing/incoming guard IDs, date, and mandatory replacement reason. (SRS 3.3.5)
  - **Given** filters are selected (client/location/date/region/supervisor), **when** the report runs, **then** the results respect all filters and can be exported to PDF/Excel. (SRS 3.3.5)

### 1.4 Store & Inventory Module
- **Uniform and shoes issuance limits**
  - **Given** a guard received a uniform within 6 months, **when** a new issuance is requested, **then** approval is required. (SRS 3.4.1)
  - **Given** a guard received shoes within 1 year, **when** a new issuance is requested, **then** approval is required. (SRS 3.4.1)
- **Inventory + absence rule**
  - **Given** a guard has no inventory and has been absent ≥ 2 months, **when** the rule evaluates, **then** the guard is flagged for resignation. (SRS 3.4.2)
- **Validity reports**
  - **Given** uniform/shoe issuance dates, **when** the validity report runs, **then** it shows uniform validity of 6 months and shoe validity of 1 year. (SRS 3.4.3)

### 1.5 Training Management Module
- **Training approval**
  - **Given** a training record is created, **when** Training Head reviews it, **then** approval is mandatory before training is marked complete. (SRS 3.5.1)
- **Training monitoring dashboards**
  - **Given** training progress data, **when** monthly/quarterly dashboards load, **then** they show progress region‑wise and supervisor‑wise. (SRS 3.5.2)
- **Deployment restriction (optional)**
  - **Given** a guard has incomplete mandatory training, **when** deployment is attempted, **then** the system blocks deployment if restriction is enabled. (SRS 3.5.3)

### 1.6 Salary & Finance Module
- **Salary reports**
  - **Given** payroll data, **when** salary reports run, **then** they are available guard‑wise, client‑wise, and region‑wise. (SRS 3.6.1)
- **Billing & invoicing**
  - **Given** billing data, **when** billing reports run, **then** they are available client‑wise and region‑wise. (SRS 3.6.2)
- **Profit & loss analysis**
  - **Given** salary and billing data, **when** P&L is generated, **then** it shows client/branch/region margins and alerts on threshold breaches. (SRS 3.6.3)

### 1.7 Dashboards & Reports
- **Role‑specific dashboards**
  - **Given** a CEO/HR/Operations/Finance user, **when** they load the system, **then** they can access the appropriate dashboard. (SRS 3.7)
- **Exportable reports**
  - **Given** a report is generated, **when** export is selected, **then** it is downloadable as PDF and Excel. (SRS 3.7)

### 1.8 Weapon & Ammunition Issuance & Control Module
- **Weapon store (Koth) management**
  - **Given** a weapon record, **when** it is created, **then** it includes type, model, serial, license, condition, and region. (SRS 3.8.1)
  - **Given** weapon inventory data, **when** the dashboard loads, **then** it shows totals in Koth, deployed counts, and region‑wise availability. (SRS 3.8.1)
- **Deployment integration**
  - **Given** a weapon issuance request, **when** the client location is not an approved armed post, **then** issuance is blocked. (SRS 3.8.2)
  - **Given** approved armed posts, **when** issuance exceeds the approved quantity, **then** issuance is blocked. (SRS 3.8.2)
  - **Given** a guard replacement at an armed post, **when** a replacement is submitted, **then** the system prompts for weapon continuity confirmation and preserves deployment history. (SRS 3.8.2)
- **Training integration**
  - **Given** a weapon issuance request, **when** the guard lacks valid weapon training/certification, **then** issuance is blocked. (SRS 3.8.3)
  - **Given** a first‑time weapon authorization or upgrade, **when** it is requested, **then** Training Head approval is mandatory. (SRS 3.8.3)
  - **Given** weapon training validity expires, **when** eligibility recalculates, **then** weapon eligibility auto‑expires. (SRS 3.8.3)
- **Guard–weapon authorization mapping**
  - **Given** a weapon is issued to a location, **when** authorization is recorded, **then** it stores authorized guards, serial number, and shift/date validity; unauthorized guards cannot be assigned. (SRS 3.8.4)
- **Ammunition control**
  - **Given** ammunition issuance norms per weapon/client, **when** a request exceeds norms, **then** an alert triggers and justification is required. (SRS 3.8.5)
- **Reports & alerts**
  - **Given** armed deployments, **when** reports run, **then** armed deployment, training compliance, authorization, and movement history are available. (SRS 3.8.6)
  - **Given** license expiry or unauthorized deployment, **when** validation runs, **then** issuance is blocked or alerts are generated. (SRS 3.8.7)

### 1.9 Security, Performance & Availability (Cross‑cutting)
- **Role‑based access control**
  - **Given** a user without permission, **when** they access a restricted module, **then** access is denied and logged. (SRS 4.1)
- **Audit logging**
  - **Given** any create/update/delete action, **when** the action is completed, **then** an audit log entry is recorded. (SRS 4.1)
- **Dashboard performance**
  - **Given** standard data volumes, **when** a dashboard loads, **then** it renders in under 5 seconds. (SRS 4.2)
- **Availability target**
  - **Given** system uptime monitoring, **when** monthly uptime is measured, **then** it meets the 99% target. (SRS 4.4)

---

## 2) QA Checklist (Aligned to SRS + Dashboards/Reports)

### 2.1 HR & Guard Enrollment
- [ ] Enrollment form captures all required guard fields.
- [ ] Required documents enforced at enrollment.
- [ ] Training Head and COO approvals require comments.
- [ ] Status auto‑classification rules are applied.

### 2.2 Compliance & Risk Monitoring
- [ ] CNIC expiry within 30 days is flagged and visible on dashboard.
- [ ] Expired CNIC guards are highlighted.
- [ ] Age policy compliance flags apply (default 55; configurable).
- [ ] Insurance/EOBI/Social Security capacity dashboards update correctly.
- [ ] Region/client addition/deletion reports reflect changes.

### 2.3 Deployment & Operations
- [ ] Live deployment dashboard shows region/client counts and shortages.
- [ ] Daily shortage report auto‑generates at 5:00 PM.
- [ ] Attendance correction notification is sent when needed.
- [ ] Rotation lock period prevents early redeployments.
- [ ] Undue shuffling detection and reports are accurate.
- [ ] Client‑wise deployment report includes replacement history and filters.
- [ ] Reports are exportable to PDF/Excel.

### 2.4 Store & Inventory
- [ ] Uniform/shoes issuance limits enforce approvals.
- [ ] No inventory + absent ≥ 2 months triggers resignation flag.
- [ ] Uniform/shoe validity reports show correct durations.

### 2.5 Training Management
- [ ] Training approval required by Training Head.
- [ ] Monthly/quarterly training dashboards show region/supervisor progress.
- [ ] Deployment restriction enforced when enabled.

### 2.6 Salary & Finance
- [ ] Salary reports available guard/client/region‑wise.
- [ ] Billing reports available client/region‑wise.
- [ ] P&L analysis shows margins and alerts on thresholds.

### 2.7 Dashboards & Reports
- [ ] CEO/HR/Operations/Finance dashboards are accessible by role.
- [ ] All reports export to PDF/Excel.

### 2.8 Weapon & Ammunition Control
- [ ] Weapon records include all required fields.
- [ ] Koth dashboard shows total, deployed, and region‑wise availability.
- [ ] Weapon issuance only for approved armed posts.
- [ ] Issuance respects approved quantity per location.
- [ ] Replacement prompts for weapon continuity; history preserved.
- [ ] Weapon issuance blocked without valid training/certification.
- [ ] Training Head approval required for first‑time/upgrade authorization.
- [ ] Ammo issuance norms enforced; excess triggers alert + justification.
- [ ] Armed deployment and compliance reports are available.

### 2.9 Security, Performance & Availability
- [ ] RBAC enforced for all modules with audit logging.
- [ ] Dashboard loads < 5 seconds on standard dataset.
- [ ] Uptime monitoring confirms 99% target.

---

## 3) Minimal Smoke Test Suite (Auth, Permissions, Core CRUD)

### 3.1 Authentication
1. **Login**: Verify valid credentials authenticate and land on the correct dashboard.
2. **Logout**: Verify session ends and protected routes redirect to login.
3. **Password reset**: Verify reset flow sends email and accepts new password.

### 3.2 Permissions (RBAC)
1. **Module access**: Non‑privileged user cannot access admin/finance modules.
2. **Action restriction**: User without create/update permission sees disabled controls and API rejects unauthorized requests.
3. **Audit trail**: Successful and blocked actions create audit log entries.

### 3.3 Core CRUD Flows
1. **Guards**: Create → view → update → deactivate/terminate a guard record.
2. **Clients & branches**: Create client, add branch, update branch details.
3. **Deployment**: Assign guard to client branch; verify deployment appears on dashboard and reports.
4. **Inventory**: Issue uniform/shoes; verify issuance limits and approval flow.
5. **Training**: Create training record; approve; verify deployment restriction (if enabled).
6. **Billing/Invoice**: Generate a client invoice; verify report availability.
7. **Weapons (if enabled)**: Create weapon record; issue to approved armed post with trained guard; verify compliance report.

---

## 4) Traceability Matrix (SRS → QA Artifacts)

| SRS Section | Acceptance Criteria | QA Checklist | Smoke Tests |
| --- | --- | --- | --- |
| 3.1 HR & Guard Enrollment | §1.1 | §2.1 | §3.3 #1 |
| 3.2 Compliance & Risk | §1.2 | §2.2 | — |
| 3.3 Deployment & Ops | §1.3 | §2.3 | §3.3 #3 |
| 3.4 Store & Inventory | §1.4 | §2.4 | §3.3 #4 |
| 3.5 Training | §1.5 | §2.5 | §3.3 #5 |
| 3.6 Salary & Finance | §1.6 | §2.6 | §3.3 #6 |
| 3.7 Dashboards & Reports | §1.7 | §2.7 | — |
| 3.8 Weapons & Ammo | §1.8 | §2.8 | §3.3 #7 |
| 4.x Non‑Functional | §1.9 | §2.9 | §3.2 #3 |

